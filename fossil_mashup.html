<head>
    <title>Fossil Mashup</title>
</head>
<body>
	<script>
	function isset(x){
		return !(typeof x === "undefined");
	}

	function validateForm(fname) {
		var x = document.forms["myForm"][fname].value;
		if (x == "") {
			alert("Name must be filled out");
			return false;
		}
		return x;
	}

    function anyset(){
        var reqs = new Array('fusee1', 'fusee2', 'x');
		var flag = false;
		for(n of reqs){
			if(isset(validateForm(n))){
				flag = true;
			}
		}

		return flag;
    }

    function areset(names){
        var flag = true;
        for(id of names) {
            if(!isset(validateForm(id)) || strlen(validateForm(id)) <= 0) 
                flag = false;
        }
        return flag;
	}	

	var row = new Array(new Array("OMASTAR", 3, "WATER", "SWIFT SWIM", "SHELL ARMOR", "WEAK ARMOR", 3, 2, 6, 5, 3, 1, 60),
						new Array("KABUTOPS", 4, "WATER", "SWIFT SWIM", "BATTLE ARMOR", "WEAK ARMOR", 1, 6, 5, 2, 3, 4, 115),
						new Array("AERODACTYL", 4, "FLYING", "ROCK HEAD", "PRESSURE", "UNNERVE", 4, 5, 1, 2, 3, 6, 105),
						new Array("CRADILY", 3, "GRASS", "SUCTION CUPS", NULL, "STORM DRAIN", 4, 2, 5, 2, 6, 1, 81),
						new Array("ARMALDO", 4, "BUG", "BATTLE ARMOR", NULL, "SWIFT SWIM", 3, 6, 5, 2, 4, 1, 125),
						new Array("RAMPARDOS", 5, "ROCK", "MOLD BREAKER", NULL, "SHEER FORCE", 5, 6, 3, 4, 1, 2, 165),
						new Array("BASTIODON", 6, "STEEL", "STURDY", NULL, "SOUNDPROOF", 4, 3, 6, 2, 5, 1, 52),
						new Array("CARRACOSTA", 5, "WATER", "SOLID ROCK", "STURDY", "SWIFT SWIM", 3, 6, 5, 4, 2, 1, 108),
						new Array("ARCHEOPS", 5, "FLYING", "DEFEATIST", NULL, "DEFEATIST", 3, 6, 1, 5, 1, 4, 140), 
						new Array("TYRANTRUM", 4, "DRAGON", "STRONG JAW", NULL, "ROCK HEAD", 4, 6, 5, 2, 1, 3, 121), 
						new Array("AURORUS", 4, "ICE", "REFRIGERATE", NULL, "SNOW WARNING", 6, 3, 2, 5, 4, 1, 77));
	var string1, string2, string3;
	for(f of row){ string2 += "<option value=" + f[0] + '>' + f[0] + "</option>"; }
	document.getElementById("p10").innerHTML = string2;
	for(f of row){ string3 += "<option value=" + f[0] + '>' + f[0] + "</option>"; }
	document.getElementById("p11").innerHTML = string3;
	</script> 

	<font face='Arial'>
	<p><h2>Select the Fusees</h2></p>
    <form name="myForm" action="fossil_mashup.html" onsubmit="return anyset()" method="post">
	<table>
		<tr>
			<td>Fusees:</td>
			<td><select name="fusee1">
			<option value=NULL> -- Head -- </option>
			</select><p id="p10">Hello World!</p>
			</td><td><select name="fusee2">
			<option value=NULL> -- Tail -- </option>
			<p id="p11">Hello World!</p>
			<script>
			</script></select></td>
		</tr>
		<tr>
			<td><select name="x">
			<option value=5> Stat Coefficient of 5</option>
			<option value=10> Stat Coefficient of 10 </option></td>
			<td><input type="submit" value="Generate" /></td>
			<td><input type="reset" value="Cancel" /></td>
		</tr>
	</table>
	</form>
	<p id="p1">Hello World!</p>

	<script>
		var head, tail, hname, tname, h, t;
		if(isset(validateForm("Randomize")){
			h = rand(0, row.length - 1);
			t = rand(0, row.length - 1);
			if(h == t) h = ++h % row.length;
			head = row[h];
			tail = row[t];
		} else if(areset(new Array('fusee1', 'fusee2', 'x'))) {
			hname = validateForm('fusee1');
			tname = validateForm('fusee2');
			for(f of row){
				if(f[0] == hname) head = f;
				if(f[0] == tname) tail = f;
			}
		}
		var name;
		name  = tail[0].substr(0, $tail[1]) + head[0].substr(head[1], head[0].length - 1) ;
		string1 += "<table border='2'><tr> <td><table border='1'><tr><td width='60'> <p>Name:</p> <p>Head:</p> <p>Tail:</p> <p>Type:</p> <p>Ability1:</p> <p>Ability2:</p> <p>HAbility:</p> </td><td width='100'>";
		string1 += "<p>" + name.toLowerCase() + "</p> <p>" + head[0].toLowerCase() + "</p> <p>" + tail[0].toLowerCase() + "</p> <p><input type='image' src='https://play.pokemonshowdown.com/sprites/types/" + head[2].toLowerCase() + ".png'>";
		if(head[2].localeCompare(tail[2]) != 0) { 
			string1 += "<input type='image' src='https://play.pokemonshowdown.com/sprites/types/" + tail[2].toLowerCase() + ".png'>";
		}
		string1 += "</p>";
		var primary, hidden, secondary;
		primary = head[3];
		hidden = (tail[5] != primary) ? (tail[5]) : (tail[3]);
		secondary = (head[3] == head[5]) ? ('---') : ((tail[3] != primary && tail[3] != hidden) ? (tail[3]) : ((head[4] != NULL && head[4] != primary && head[4] != hidden) ? (head[4]) : ('---')) );
		string1 += "<p>" + primary + "</p> <p>" + secondary + "</p> <p>" + hidden + "</p> </td><td><input type='image' src='https://play.pokemonshowdown.com/sprites/dex/" + strtolower(head[0]) + ".png'> </td></tr><tr><td><table border=1><tr><td width=60>HP</td></tr><tr><td width=60>ATK</td></tr><tr><td width=60>DEF</td></tr><tr><td width=60>SPA</td></tr><tr><td width=60>SPD</td></tr><tr><td width=60>SPE</td></tr><tr><td width=60>BST</td></tr></table></td><td><table border=1>"; 
			var val, bst, most, x, y;
			bst = 0; 
			most = array(-1, 255);
			x = validateForm('x');
			y = (510 - 42 * $x) / 6;
			for(var i = 0; $i < 6; $i++){
				val[i] = ((head[6 + i] + tail[6 + i]) * x + y);
				bst += val[i];
				if(val[i] < most[1]){
					most[0] = i; 
					most[1] = val[i];
				}
			}
			if(bst == 510){
				val[most[0]] -= 5;
				bst -= 5;
			} elseif(bst == 500){
				val[most[0]] += 5;
				bst += 5;
			} 
			if(head[12] > tail[12]){
				tmp = val[1];
				val[1] = val[2];
				val[2] = tmp;
				tmp = val[3];
				val[3] = val[4];
				val[4] = tmp;
			}
			for(stat of val)
				string1 += '<tr><td width=120>' + $stat + '</td></tr>'; 
			string1 += '<tr><td width=110>' + $bst + '</td></tr>'; 
			string1 += '</table></td><td><input type="image" src="https://play.pokemonshowdown.com/sprites/dex/' + strtolower($tail[0]) + '.png">';
		document.getElementById("p2").innerHTML = string1;
			</script></td>
			</tr></table></td>
		</tr></table>
	</font></p>
</body>